10 REM PROGRAMMING THE 6845 CRTC
20 REM SIDEWAYS SCROLLING BY DIRECTLY 
30 REM ADDRESSING SHEILA LOCATIONS

240
250 OSWRCH=&FFEE:OSBYTE=&FFF4
260 SCR=&70
270 DIM START 1000
280 FOR PASS=0 TO 3 STEP 3
290 P%=START
300 RESTORE
310
320 REM SET UP TEST GRAPHICS SCREEN 
330 PROCvdu(29)
340 DATA 22,2,18,0,132,16,18,0,3,25,4,500@,500@,25,1,200@,0@,25,81,0@,-200@,25 ,1,-200@,0@,25,81,0@,200@
350
360 [OPT PASS 
370 .BEGIN 
380 LDA #&00 
390 STA SCR 
400 LDA #&06 
410 STA SCR+1
420 .SCROLL 
430 LDA #&13 
440 JSR OSBYTE 
450 LDA #&0D 
460 STA &FE00 
470 LDA SCR 
480 STA &FE01 
490 BNE OVER 
500 LDA #&0C 
510 STA &FE00 
520 LDA SCR+1 
530 STA &FE01 
540 .OVER
550 INC SCR 
560 BNE SKIP 
570 INC SCR+1 
580 .SKIP
590 LDA SCR 
600 BNE SCROLL 
610 LDA SCR+1 
620 CMP #&10 
630 BNE SCROLL 
640 BEQ BEGIN 
650 RTS:]
660 NEXT PASS 
670 CALL START
680 END
1060 DEFPROCvdu(N)
1070 LOCAL D,D$,B,byte,item,lbyte
1080 FOR item=1 TO N
1090 READ D$
10100 IF RIGHT$(D$,1)="@" THEN B=2 ELSE B=1
10110 D=EVAL(D$)
10120 IF ASC(D$)>64 THEN [OPT PASS:LDA D :JSR OSWRCH:]:NEXT item
10130 IF D<0 THEN D=(ABS(D) EOR &FFFF)+1 
10140 byte=D MOD 256:PROCform
10150 IF B=2 THEN byte=D DIV 256:PROCform
10160 NEXT item
10170 ENDPROC
10180
10190 DEFPROCform
10200 IF byte<>lbyte THEN [OPT PASS:LDA#byte:]
10210 [OPT PASS:JSR OSWRCH:]
10220 lbyte=byte
10230 ENDPROC