10 REM MOVING MULTICOLOURED OBJECTS 
20 REM AN IMPROVED METHOD FOR MODE 2 
30 REM USING 80*256 BYTE COORDINATES 
130
140 OSWRCH=&FFEE:OSBYTE=&FFF4
150 XCOORD=&70:YCOORD=&71:width=&72:height=&73:wcount=&74:LOC=&75
160 STORE=&77:data=&79:Yreg=&7B 
170 table1=&7C:table2=&7E
180 XCOORD1=&80:YCOORD1=&81
190 XCOORD2=&82:YCOORD2=&83
200 DIM START 1000
210 FOR PASS=0 TO 2 STEP 2 
220 P%=START
230 RESTORE
240 [OPT PASS
250
260 LDA #&16
270 JSR OSWRCH
280 LDA #2
290 JSR OSWRCH
300 LDA #(shape1 MOD 256)
310 STA table1
320 LDA #(shape1 DIV 256)
330 STA table1+1
340 LDA #(shape2 MOD 256)
350 STA table2
360 LDA #(shape2 DIV 256)
370 STA table2+1
380 LDA #0
390 STA XCOORD1
400 STA YCOORD1
410 LDA #34
420 STA XCOORD2
430 LDA #200
440 STA YCOORD2
450
460 .LOOP
470 INC XCOORD1
480 INC YCOORD1
490 DEC YCOORD2
500 JSR SCREEN
510 LDA YCOORD2
520 CMP #80
530 BNE LOOP
540 BEQ START
550
560 .SCREEN
570 LDA table1
580 STA data
590 LDA table1+1
600 STA data+1 
610 LDA #&13
620 JSR OSBYTE
630 LDX XCOORD1
640 LDY YCOORD1
650 JSR draw
660 LDAtable2
670 STA data
680 LDA table2+1
690 STA data+1
700 LDX XCOORD2
710 LDY YCOORD2
720 JSR draw
730 RTS 
740
750 .draw
760 STX XCOORD
770 STY YCOORD
780 LDY #0
790 LDA (data),Y
800 STA height
810 INY
820 LDA (data),Y
830 STA width
840 LDX #2
850 .newrow
860 LDA #0
870 STA Yreg
880 LDA width
890 STA wcount
900 JSR CALCADDRESS 
910 .newcolumn
920 TXA 
930 TAY 
940 LDA (data),Y
950 LDY Yreg
960 STA (LOC),Y
970 TYA 
980 ADC #8
990 STA Yreg
1000 INX
1010 DEC wcount
1020 BNE newcolumn
1030 INC YCOORD
1040 DEC height
1050 BNE newrow
1060 RTS
1070
1080 .CALCADDRESS 
1090 LDA #0
1100 STA STORE+1 
1110 STA LOC
1120 LDA XCOORD
1130 ASL A
1140 ASL A
1150 ROL STORE+1 
1160 ASL A
1170 ROL STORE+1 
1180 STA STORE
1190 LDA YCOORD
1200 AND #&F8
1210 LSR A
1220 LSR A 
1230 STA LOC+1
1240 LSR A
1250 LSR A
1260 ROR LOC
1270 ADC LOC+1
1280 TAY
1290 LDA YCOORD
1300 AND #7
1310 ADC LOC
1320 ADC STORE
1330 STA LOC
1340 TYA
1350 ADC STORE+1 
1360 ADC #&30 
1370 STA LOC+1 
1380 RTS
1390
1400 .shape1
1410 OPT FNdatatable(86)
1420 .shape2
1430 OPT FNdatatable(62)
1440 RTS:]
1450 NEXT PASS
1460 CALL START
1470
1480 REM THIS IS THE shape1 DATA 
1490 DATA E,6
1500 DATA 0,0,0,0,0,0
1510 DATA 0,0,0,0,0,0
1520 DATA 0,0,4F,8F,0,0
1530 DATA 0,0,1,2,0,0
1540 DATA 0,0,1,2,0,0
1550 DATA 0,0,3,3,0,0
1560 DATA 0,1,3,3,2,0
1570 DATA 0,3,9,6,3,0
1580 DATA 0,3,3,3,3,0
1590 DATA 0,3,3,3,3,0
1600 DATA 0,3,3,3,3,0
1610 DATA 0,0,2,1,0,0
1620 DATA 0,0,0,0,0,0
1630 DATA 0,0,0,0,0,0
1640
1650 REM THIS IS THE shape2 DATA
1660 DATA A,6
1670 DATA 0,0,0,0,0,0 
1680 DATA 0,0,0,0,0,0 
1690 DATA 0,0,1,2,0,0 
1700 DATA 0,0,3,3,0,0 
1710 DATA 0,1,3,3,2,0 
1720 DATA 0,3,9,6,3,0 
1730 DATA 0,3,3,3,3,0 
1740 DATA 0,0,2,1,0,0 
1750 DATA 0,0,0,0,0,0 
1760 DATA 0,0,0,0,0,0
1860 DEF FNdatatable(N) 
1870 FOR item=1 TO N
1880 READ D$
1890 D=EVAL("&"+D$)
1900 ?P%=D:P%=P%+1 
1910 NEXT item
1920 =PASS